{% comment %}
  Main Password Section - Elle Theme
  Password page for store in password mode
{% endcomment %}

<section class="main-password section {% render 'color-scheme', scheme: section.settings.color_scheme %}">
  <div class="container">
    <div class="main-password__content text-center">
      {%- if section.settings.logo != blank -%}
        <div class="main-password__logo">
          {{
            section.settings.logo
            | image_url: width: 400
            | image_tag:
              loading: 'eager',
              width: section.settings.logo_width,
              class: 'main-password__logo-image'
          }}
        </div>
      {%- else -%}
        <h1 class="main-password__shop-name h1">{{ shop.name }}</h1>
      {%- endif -%}

      {%- if section.settings.heading != blank -%}
        <h2 class="main-password__heading h2">{{ section.settings.heading }}</h2>
      {%- endif -%}

      {%- if section.settings.text != blank -%}
        <div class="main-password__text rte">
          {{ section.settings.text }}
        </div>
      {%- endif -%}

      {%- comment -%} Newsletter Signup {%- endcomment -%}
      {%- if section.settings.show_newsletter -%}
        <div class="main-password__newsletter">
          {%- form 'customer', class: 'password-newsletter-form' -%}
            <input type="hidden" name="contact[tags]" value="password-page">

            {%- if form.posted_successfully? -%}
              <p class="form-message form-message--success">
                {{ 'newsletter.success' | t }}
              </p>
            {%- else -%}
              {%- if form.errors -%}
                <p class="form-message form-message--error">
                  {{ form.errors.messages['email'] }}
                </p>
              {%- endif -%}

              <div class="password-newsletter-form__field">
                <label for="PasswordEmail" class="visually-hidden">{{ 'newsletter.email_placeholder' | t }}</label>
                <input
                  type="email"
                  id="PasswordEmail"
                  name="contact[email]"
                  class="form-input"
                  placeholder="{{ 'newsletter.email_placeholder' | t }}"
                  required
                  autocomplete="email"
                >
                <button type="submit" class="btn btn--filled">
                  {{ 'newsletter.subscribe' | t }}
                </button>
              </div>
            {%- endif -%}
          {%- endform -%}
        </div>
      {%- endif -%}

      {%- comment -%} Password Entry {%- endcomment -%}
      <div class="main-password__login">
        <button type="button" class="main-password__login-btn link" data-password-toggle>
          {{ 'password.enter_password' | t }}
        </button>

        <div class="main-password__form" data-password-form hidden>
          {%- form 'storefront_password', class: 'password-form' -%}
            {%- if form.errors -%}
              <p class="form-message form-message--error">
                {{ 'password.wrong_password' | t }}
              </p>
            {%- endif -%}

            <div class="password-form__field">
              <label for="Password" class="visually-hidden">{{ 'password.password' | t }}</label>
              <input
                type="password"
                id="Password"
                name="password"
                class="form-input"
                placeholder="{{ 'password.password' | t }}"
                required
              >
              <button type="submit" class="btn btn--filled">
                {{ 'password.submit' | t }}
              </button>
            </div>
          {%- endform -%}
        </div>
      </div>

      {%- comment -%} Social Links {%- endcomment -%}
      {%- if section.settings.show_social -%}
        <div class="main-password__social">
          {%- if settings.social_facebook_link != blank -%}
            <a href="{{ settings.social_facebook_link }}" target="_blank" rel="noopener noreferrer" aria-label="Facebook">
              {% render 'icon', icon: 'facebook' %}
            </a>
          {%- endif -%}
          {%- if settings.social_instagram_link != blank -%}
            <a href="{{ settings.social_instagram_link }}" target="_blank" rel="noopener noreferrer" aria-label="Instagram">
              {% render 'icon', icon: 'instagram' %}
            </a>
          {%- endif -%}
          {%- if settings.social_twitter_link != blank -%}
            <a href="{{ settings.social_twitter_link }}" target="_blank" rel="noopener noreferrer" aria-label="Twitter">
              {% render 'icon', icon: 'twitter' %}
            </a>
          {%- endif -%}
          {%- if settings.social_pinterest_link != blank -%}
            <a href="{{ settings.social_pinterest_link }}" target="_blank" rel="noopener noreferrer" aria-label="Pinterest">
              {% render 'icon', icon: 'pinterest' %}
            </a>
          {%- endif -%}
          {%- if settings.social_tiktok_link != blank -%}
            <a href="{{ settings.social_tiktok_link }}" target="_blank" rel="noopener noreferrer" aria-label="TikTok">
              {% render 'icon', icon: 'tiktok' %}
            </a>
          {%- endif -%}
        </div>
      {%- endif -%}
    </div>
  </div>
</section>

<script>
(function() {
  const toggleBtn = document.querySelector('[data-password-toggle]');
  const passwordForm = document.querySelector('[data-password-form]');

  if (toggleBtn && passwordForm) {
    toggleBtn.addEventListener('click', () => {
      passwordForm.hidden = !passwordForm.hidden;
      if (!passwordForm.hidden) {
        passwordForm.querySelector('input[type="password"]').focus();
      }
    });
  }
})();
</script>

{% stylesheet %}
  /* Container - centered, constrained width */
  .main-password {
    display: flex;
    align-items: center;
    justify-content: center;
    flex: 1;
    padding: var(--space-8);
  }

  .main-password__content {
    width: 100%;
    max-width: 480px;
    margin: 0 auto;
  }

  /* Logo */
  .main-password__logo {
    margin-bottom: var(--space-8);
  }

  .main-password__logo-image {
    display: block;
    margin: 0 auto;
    height: auto;
  }

  .main-password__shop-name {
    margin-bottom: var(--space-8);
  }

  /* Typography */
  .main-password__heading {
    margin-bottom: var(--space-4);
  }

  .main-password__text {
    color: var(--color-muted);
    margin-bottom: var(--space-8);
    line-height: var(--line-height-relaxed);
  }

  .main-password__text p:last-child {
    margin-bottom: 0;
  }

  /* Newsletter form */
  .main-password__newsletter {
    margin-bottom: var(--space-10);
  }

  .password-newsletter-form__field {
    display: flex;
    gap: var(--space-3);
  }

  .password-newsletter-form__field .form-input {
    flex: 1;
  }

  /* Password/login section */
  .main-password__login {
    padding-top: var(--space-8);
    border-top: 1px solid var(--color-border);
  }

  .main-password__login-btn {
    font-size: var(--font-size-sm);
    color: var(--color-muted);
    text-decoration: underline;
    text-underline-offset: 0.2em;
    transition: color var(--duration-fast) var(--ease-out);
  }

  .main-password__login-btn:hover {
    color: var(--color-foreground);
  }

  .main-password__form {
    margin-top: var(--space-6);
  }

  .password-form__field {
    display: flex;
    gap: var(--space-3);
  }

  .password-form__field .form-input {
    flex: 1;
  }

  /* Social links */
  .main-password__social {
    display: flex;
    justify-content: center;
    gap: var(--space-4);
    margin-top: var(--space-10);
  }

  .main-password__social a {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 2.5rem;
    height: 2.5rem;
    color: var(--color-foreground);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-full);
    transition: all var(--duration-fast) var(--ease-out);
  }

  .main-password__social a:hover {
    background-color: var(--color-foreground);
    color: var(--color-background);
    border-color: var(--color-foreground);
  }

  .main-password__social svg {
    width: 1rem;
    height: 1rem;
  }

  /* Form messages */
  .main-password .form-message {
    text-align: left;
    margin-bottom: var(--space-4);
  }

  /* Responsive - stack forms on mobile */
  @media (max-width: 480px) {
    .password-newsletter-form__field,
    .password-form__field {
      flex-direction: column;
    }

    .password-newsletter-form__field .btn,
    .password-form__field .btn {
      width: 100%;
    }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "t:sections.main_password.name",
  "tag": "section",
  "class": "section-main-password",
  "settings": [
    {
      "type": "image_picker",
      "id": "logo",
      "label": "t:sections.main_password.settings.logo.label"
    },
    {
      "type": "range",
      "id": "logo_width",
      "label": "t:sections.main_password.settings.logo_width.label",
      "min": 50,
      "max": 300,
      "step": 10,
      "unit": "px",
      "default": 150
    },
    {
      "type": "text",
      "id": "heading",
      "label": "t:labels.heading",
      "default": "Opening soon"
    },
    {
      "type": "richtext",
      "id": "text",
      "label": "t:labels.text",
      "default": "<p>Be the first to know when we launch. Subscribe to our newsletter for exclusive updates.</p>"
    },
    {
      "type": "checkbox",
      "id": "show_newsletter",
      "label": "t:sections.main_password.settings.show_newsletter.label",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_social",
      "label": "t:sections.main_password.settings.show_social.label",
      "default": true
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:labels.color_scheme",
      "default": "scheme_1"
    }
  ]
}
{% endschema %}
