{% comment %}
  Testimonial Card Snippet - Elle Theme
  Renders an individual testimonial in an understated, classy style

  Parameters:
  - block: The testimonial block object
  - show_rating: Whether to display the star rating (default: true)
{% endcomment %}

{%- liquid
  unless show_rating == false
    assign show_rating = true
  endunless
-%}

{%- if show_rating == true and block.settings.rating > 0 -%}
  <div class="testimonial-card__rating" aria-label="{{ 'testimonials.rating' | t: rating: block.settings.rating }}">
    {%- for i in (1..5) -%}
      {%- if i <= block.settings.rating -%}
        {% render 'icon', icon: 'star-filled', size: 'xs' %}
      {%- else -%}
        {% render 'icon', icon: 'star', size: 'xs' %}
      {%- endif -%}
    {%- endfor -%}
  </div>
{%- endif -%}

{%- if block.settings.quote != blank -%}
  <blockquote class="testimonial-card__quote">
    {{ block.settings.quote }}
  </blockquote>
{%- endif -%}

<div class="testimonial-card__author">
  {%- if block.settings.author_image -%}
    <div class="testimonial-card__avatar">
      {{
        block.settings.author_image
        | image_url: width: 80
        | image_tag:
          loading: 'lazy',
          width: 40,
          height: 40,
          class: 'testimonial-card__avatar-img'
      }}
    </div>
  {%- endif -%}
  <div class="testimonial-card__info">
    {%- if block.settings.author_name != blank -%}
      <cite class="testimonial-card__name">{{ block.settings.author_name }}</cite>
    {%- endif -%}
    {%- if block.settings.author_title != blank -%}
      <span class="testimonial-card__title">{{ block.settings.author_title }}</span>
    {%- endif -%}
  </div>
</div>

<style>
  .testimonial-card__rating {
    display: flex;
    gap: 0.125rem;
    margin-bottom: var(--space-4);
    color: var(--color-foreground);
    opacity: 0.6;
  }

  .testimonial-card__rating svg {
    width: 0.875rem;
    height: 0.875rem;
  }

  .testimonial-card__quote {
    font-size: var(--font-size-sm);
    font-style: normal;
    line-height: var(--line-height-relaxed);
    margin: 0 0 var(--space-5);
    opacity: 0.8;
  }

  .testimonial-card__author {
    display: flex;
    align-items: center;
    gap: var(--space-3);
  }

  .testimonial-card__avatar {
    flex-shrink: 0;
    width: 2.5rem;
    height: 2.5rem;
    border-radius: 50%;
    overflow: hidden;
  }

  .testimonial-card__avatar-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .testimonial-card__info {
    display: flex;
    flex-direction: column;
    gap: 0.125rem;
  }

  .testimonial-card__name {
    font-size: var(--font-size-sm);
    font-style: normal;
    font-weight: var(--font-weight-medium);
    line-height: 1.3;
  }

  .testimonial-card__title {
    font-size: var(--font-size-xs);
    opacity: 0.6;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }
</style>
